<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
      <title>Descobrir M√∫sica</title>
        <link rel="manifest" href="manifest.json">
          <meta name="theme-color" content="#1db954">
            <style>
                * {
                      box-sizing: border-box;
                            margin: 0;
                                  padding: 0;
                                      }

                                          body {
                                                font-family: Arial, sans-serif;
                                                      background: #111;
                                                            color: #fff;
                                                                  display: flex;
                                                                        flex-direction: column;
                                                                              align-items: center;
                                                                                    min-height: 100vh;
                                                                                        }

                                                                                            /* Menu superior */
                                                                                                nav {
                                                                                                      position: fixed;
                                                                                                            top: 0;
                                                                                                                  left: 0;
                                                                                                                        width: 100%;
                                                                                                                              background: #1db954;
                                                                                                                                    padding: 12px 0;
                                                                                                                                          text-align: center;
                                                                                                                                                z-index: 1000;
                                                                                                                                                      display: flex;
                                                                                                                                                            justify-content: center;
                                                                                                                                                                  gap: 25px;
                                                                                                                                                                      }

                                                                                                                                                                          nav a {
                                                                                                                                                                                color: #fff;
                                                                                                                                                                                      text-decoration: none;
                                                                                                                                                                                            font-weight: bold;
                                                                                                                                                                                                  font-size: 1em;
                                                                                                                                                                                                      }

                                                                                                                                                                                                          nav a:hover {
                                                                                                                                                                                                                text-decoration: underline;
                                                                                                                                                                                                                    }

                                                                                                                                                                                                                        /* Espa√ßo para o menu fixo */
                                                                                                                                                                                                                            .spacer {
                                                                                                                                                                                                                                  height: 60px;
                                                                                                                                                                                                                                        width: 100%;
                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                h1 {
                                                                                                                                                                                                                                                      color: #1db954;
                                                                                                                                                                                                                                                            font-size: 2em;
                                                                                                                                                                                                                                                                  margin: 20px 0;
                                                                                                                                                                                                                                                                        text-align: center;
                                                                                                                                                                                                                                                                              padding: 0 10px;
                                                                                                                                                                                                                                                                                  }

                                                                                                                                                                                                                                                                                      button {
                                                                                                                                                                                                                                                                                            padding: 18px 36px;
                                                                                                                                                                                                                                                                                                  font-size: 1.2em;
                                                                                                                                                                                                                                                                                                        border: none;
                                                                                                                                                                                                                                                                                                              border-radius: 12px;
                                                                                                                                                                                                                                                                                                                    background: #1db954;
                                                                                                                                                                                                                                                                                                                          color: white;
                                                                                                                                                                                                                                                                                                                                cursor: pointer;
                                                                                                                                                                                                                                                                                                                                      transition: background 0.3s;
                                                                                                                                                                                                                                                                                                                                            width: 80%;
                                                                                                                                                                                                                                                                                                                                                  max-width: 300px;
                                                                                                                                                                                                                                                                                                                                                        text-align: center;
                                                                                                                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                                                                                                                                button:hover {
                                                                                                                                                                                                                                                                                                                                                                      background: #17a44a;
                                                                                                                                                                                                                                                                                                                                                                          }

                                                                                                                                                                                                                                                                                                                                                                              #result {
                                                                                                                                                                                                                                                                                                                                                                                    margin-top: 30px;
                                                                                                                                                                                                                                                                                                                                                                                          width: 90%;
                                                                                                                                                                                                                                                                                                                                                                                                max-width: 350px;
                                                                                                                                                                                                                                                                                                                                                                                                      text-align: center;
                                                                                                                                                                                                                                                                                                                                                                                                          }

                                                                                                                                                                                                                                                                                                                                                                                                              .card {
                                                                                                                                                                                                                                                                                                                                                                                                                    background: #1e1e1e;
                                                                                                                                                                                                                                                                                                                                                                                                                          padding: 20px;
                                                                                                                                                                                                                                                                                                                                                                                                                                border-radius: 12px;
                                                                                                                                                                                                                                                                                                                                                                                                                                      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
                                                                                                                                                                                                                                                                                                                                                                                                                                            margin-top: 20px;
                                                                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                                                                    .card h2 {
                                                                                                                                                                                                                                                                                                                                                                                                                                                          font-size: 1.4em;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                color: #1db954;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      margin-bottom: 8px;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                              .card p {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    font-size: 1.1em;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          margin-bottom: 12px;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  .card a {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        display: inline-block;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              padding: 10px 20px;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    background: #ff0000;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          color: #fff;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                border-radius: 8px;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      text-decoration: none;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            font-weight: bold;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    .card a:hover {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          background: #cc0000;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </style>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </head>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <body>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <!-- Menu superior -->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <nav>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <a href="#">In√≠cio</a>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <a href="#">Configura√ß√µes</a>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <a href="#">Sobre</a>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </nav>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <div class="spacer"></div>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <h1>üéµ Descobrir M√∫sica</h1>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <button id="recordBtn">Ouvir m√∫sica</button>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <div id="result"></div>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                const recordBtn = document.getElementById("recordBtn");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    const resultDiv = document.getElementById("result");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        let mediaRecorder, audioChunks = [];

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Token do AudD
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                const API_TOKEN = "1253e68c1a2f49c8286adce76e40e873";

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    recordBtn.addEventListener("click", async () => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          if (!navigator.mediaDevices.getUserMedia) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  alert("Seu navegador n√£o suporta microfone.");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          return;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            mediaRecorder = new MediaRecorder(stream);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  audioChunks = [];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        mediaRecorder.ondataavailable = e => audioChunks.push(e.data);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              mediaRecorder.onstop = async () => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      const audioBlob = new Blob(audioChunks, { type: "audio/wav" });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              const formData = new FormData();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      formData.append("api_token", API_TOKEN);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              formData.append("file", audioBlob, "recording.wav");

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      resultDiv.innerHTML = "<p>‚è≥ Procurando m√∫sica...</p>";

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              try {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        const response = await fetch("https://api.audd.io/", {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    method: "POST",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                body: formData
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    const data = await response.json();

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              if (data.result && data.result.title && data.result.artist) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          const query = encodeURIComponent(`${data.result.title} ${data.result.artist}`);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      const youtubeUrl = `https://www.youtube.com/results?search_query=${query}`;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  resultDiv.innerHTML = `
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <div class="card">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <h2>${data.result.title}</h2>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <p>${data.result.artist}</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <a href="${youtubeUrl}" target="_blank">‚ñ∂Ô∏è Abrir no YouTube</a>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                resultDiv.innerHTML = "<p>‚ùå N√£o consegui identificar a m√∫sica.</p>";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  } catch (err) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            resultDiv.innerHTML = "<p>‚ùå Erro ao tentar identificar a m√∫sica.</p>";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      console.error(err);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    };

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          mediaRecorder.start();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                recordBtn.textContent = "üé§ Gravando (5s)...";

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      setTimeout(() => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              mediaRecorder.stop();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      recordBtn.textContent = "Ouvir m√∫sica";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }, 5000);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                });

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Registrar service worker para PWA
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if ("serviceWorker" in navigator) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              navigator.serviceWorker.register("service-worker.js");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </script>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </body>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </html>